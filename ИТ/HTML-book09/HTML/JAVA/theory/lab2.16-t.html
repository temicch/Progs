<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//RU">
<HTML>
<HEAD>
<TITLE>Теория к лаб. работе N 2.16</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1251">
<link REL="stylesheet" TYPE="text/css" HREF="mstyle.css">
</HEAD>
<BODY>
     <h2>Реклама: строка состояния, баннеры и слайд-шоу.</h2>
<p>Разработчики Web-страниц используют целый ряд хитростей рекламного характера, начиная от заманчивых заголовков, броского дизайна и заканчивая Flash-анимацией, что привлекает внимание посетителей к информации о товарах или событиях. И хотя многие подобные приемы требуют от разработчика художественного таланта и умения работать с программами анимации, такими как Macromedia Flash, некоторые из них вполне возможно создать с спомощью сценариев JavaScript, даже если разработчик не является великим художником.
<p>Для таких хитрых приемов используются сообщения в строке состояния, баннеры и слайд-шоу, которые позволяют придать шик Web-странице и представить ее посетителю в лучшем виде. Этим вопросам и будет посвящена данная лабораторная.
<br><br>
<h2>Строка состояния</h2>
<i>Строка состояния</i> располагается в нижней части браузера и используется для отображения короткого сообщения для посетителей Web-страницы. И хотя большинство браузеров самостоятельно отображают различную информацию в ней, некоторые разработчики взяли инициативу в свои руки.
<p>Разработчики, которые хотят использовать строку состояния, придумывают самые различные способы для гармоничного встраивания строки состояния в общую картину страницы. Некоторые разработчики внедряют в строку состояния сообщения, которые видит посетитель при попадании на страницу. Другие разработчики изменяют это сообщение в зависимости от того, какие действия посетитель предпринимает на странице. Некоторые красочно выделяют сообщение, размещенное в строке состояния, всеми силами пытаясь заставить посетителя прочесть это сообщение. 
<p>Для начала разберемся, как записывать сообщение в строку состояния. Все, что вам необходимо для этого сделать - всего лишь записать нужную строку в <i>window.status.</i> В следующем примере создаются две кнопки, которые можно использовать, чтобы записывать некий текст в строку состояния и, соответственно, затем его стирать. 
<br><br>
<input type="button" value="Писать!">   <input type="button" value="Стереть!">
<br><br>
Данный скрипт выглядит следующим образом: 
<table><tr><td bgcolor=aqua><pre><xmp>
<html>
<head>
<script language="JavaScript">
<!-- hide

function statbar(txt) {
   window.status = txt;
}

// -->
</script>
</head>
<body>

<form>
  <input type="button" name="look" value="Писать!" 
    onClick="statbar('Привет! Это окно состояния!');">
  <input type="button" name="erase" value="Стереть!" onClick="statbar('');">
</form>

</body>
</html>
</xmp></pre></td></tr></table>
<br>
Итак, мы создаем форму с двумя кнопками. Обе эти кнопки вызывают функцию statbar(). Вызов от клавиши <i>Писать!</i> выглядит следующим образом: 
<table><tr><td bgcolor=aqua><pre><xmp>
statbar('Привет! Это окно состояния!');
</xmp></pre></td></tr></table>
<br>
В скобках мы написали строку:<i>'Привет! Это окно состояния!'.</i>Это как раз и будет текст, передаваемый функции statbar(). В свою очередь, можно видеть, что функция statbar() определена следующим образом:
<table><tr><td bgcolor=aqua><pre><xmp>
function statbar(txt) {
   window.status = txt;
}
</xmp></pre></td></tr></table>
<br>
В заголовке функции в скобках мы поместили слово <i>txt.</i> Это означает, что строка, которую мы передали этой функции, помещается в переменную <i>txt.</i><br>
Передача функциям переменных - прием, часто применяемый для придания функциям большей гибкости. Вы можете передать функции несколько таких аргументов - необходимо лишь отделить их друг от друга запятыми.<br>
Строка <i>txt</i> заносится в строку состояния посредством команды <i>window.status = txt.</i><br>
Соответственно, удаление текста из строки состояния выполняется как запись в <i>window.status</i> пустой строки. 
<p>Механизм вывода текста в строку состояния удобно использовать при работе со ссылками. Вместо того, чтобы выводить на экран URL данной ссылки, Вы можете просто на словах объяснять, о чем будет говориться на следующей странице. Так <a href="javascript:void(0);"><u>link</u></a> демонстрирует это - достаточно лишь поместить указатель вашей мыши над этой ссылкой. Исходный код этого примера выглядит следующим образом: 
<table><tr><td bgcolor=aqua><pre><xmp>
<a href="dontclck.htm" 
  onMouseOver="window.status='Don\'t click me!'; return true;"
  onMouseOut="window.status='';">link</a> 
</xmp></pre></td></tr></table>
<br>
Здесь мы пользуемся процедурами <i>onMouseOver</i> и <i>onMouseOut</i>, чтобы отслеживать моменты, когда указатель мыши проходит над данной ссылкой.<br>
Вы можете спросить, а почему в onMouseOver мы обязаны возвращать результат <i>true</i>. На самом деле это означает, что браузер не должен вслед за этим выполнять свой собственный код обработки события MouseOver. Как правило, в строке состояния браузер показывает URL соответствующей ссылки. Если же мы не возвратим значение <i>true</i>, то сразу же после того, как наш код был выполнен, браузер перепишет строку состояния на свой лад - то есть наш текст будет тут же затерт и читатель не сможет его увидеть. В общем случае, мы всегда можем отменить дальнейшую обработку события браузером, возвращая <i>true</i> в своей собственной процедуре обработки события.  
<p>В этом скрипте Вы можете видеть еще одну вещь - в некоторых случаях Вам понадобится печатать символы кавычек. Например, мы хотим напечатать текст <i>Don't click me</i> - однако поскольку мы передаем эту строку в процедуру обработки события onMouseOver, то мы используем для этого одинарные кавычки. Между тем, как слово <i>Don't</i> тоже содержит символ одинарной кавычки! И в результате если Вы просто впишете <i>'Don't ...'</i>, браузер запутается в этих символах '. Чтобы разрешить эту проблему, Вам достаточно лишь поставить обратный слэш \ перед символом кавычки - это означает, что данный символ предназначен именно для печати. (То же самое Вы можете делать и с двойными кавычками - ").
<h3>Прокрутка</h3>
Теперь, когда Вы знаете, как делать записи в строке состояния и как работать с таймерами, мы можем перейти к управлению прокруткой. Вы уже могли видеть, как текст перемещается строке состояния. В Интернет этим приемом пользуются повсеместно. Теперь же мы рассмотрим, как можно запрограммировать прокрутку в основной линейке. Рассмотрим также и всевозможные усовершенствования этой линейки.<br>
Создать бегущую строку довольно просто. Для начала давайте задумаемся, как вообще можно создать в строке состояния перемещающийся текст - бегущую строку. Очевидно, сперва мы должны записать в строку состояния некий текст. Затем по истечении короткого интервала времени мы должны записать туда тот же самый текст, но при этом немного переместив его влево. Если мы это сделаем несколько раз, то у пользователя создастся впечатление, что он имеет дело с бегущей строкой.<br>
Однако при этом мы должны помнить еще и о том, что обязаны каждый раз вычеслять, какую часть текста следует показывать в строке состояния (как правило, объем текстового материала превышает размер строки состояния).
<p>Эта кнопка откроет окно и покажет образец прокрутки:<br><br>
<input type="button" value="Scroller">
<p>Итак, исходный код скрипта:
<table><tr><td bgcolor=aqua><pre><xmp>
<html>
<head>
<script language="JavaScript">
<!-- hide


// define the text of the scroller
var scrtxt = "Это JavaScript! " +
    "Это JavaScript! " +
    "Это JavaScript!"; 
var len = scrtxt.length;
var width = 100;
var pos = -(width + 2);

function scroll() {

  // напечатать заданный текст справа и установить таймер 

  // перейти на исходную позицию для следующего шага 
  pos++;

  // вычленить видимую часть текста 
  var scroller = "";
  if (pos == len) {
    pos = -(width + 2);
  }

  // если текст еще не дошел до левой границы, то мы должны 
  // добавить перед ним несколько пробелов. В противном случае мы должны 
  // вырезать начало текста (ту часть, что уже ушла за левую границу 
  if (pos < 0) {
    for (var i = 1; i <= Math.abs(pos); i++) {
      scroller = scroller + " ";}
    scroller = scroller + scrtxt.substring(0, width - i + 1);
  }
  else {
    scroller = scroller + scrtxt.substring(pos, width + pos);
  }

  // разместить текст в строке состо\яни\я 
  window.status = scroller;

  // вызвать эту функцию вновь через 100 миллисекунд 
  setTimeout("scroll()", 100);
}

// -->
</script>
</head>

<body onLoad="scroll()">
Это пример прокрутки в строке состояния средствами JavaScript.
</body>
</html>
</xmp></pre></td></tr></table>
<p>Большая часть функции scroll() нужна для вычленения той части текста, которая будет показана пользователю. Мы не будем объяснять этот код подробно - вам необходимо лишь понять, как вообще осуществляется эта прокрутка.<br>
Чтобы запустить этот процесс, мы используемся процедурой обработки события onLoad, описанной в тэге &LT;body&GT;. То есть функция <i>scroll()</i> будет вызвана сразу же после загрузки HTML-страницы.<br>
Через посредство процедуры onLoad мы вызываем функцию scroll(). Первым делом в функции scroll() мы устанавливаем таймер. Этим гарантируется, что функция scroll() будет повторно вызвана через 100 миллисекунд. При этом текст будет перемещен еще на один шаг и запущен другой таймер. Так будет продолжаться без конца.
<h3>Бегущая строка с указанием даты и времени.</h3>
<p>Можно изменить бегущую строку путем добавления в нее даты и времени. Это очень просто сделать, если сначала определить текущую дату и время путем создания экземпляра объекта <i>Date()</i>. Вот пример:
<table><tr><td bgcolor=aqua><pre><xmp>
Today = new Date();
</xmp></pre></td></tr></table>
<br>
Далее нужно вызвать метод <i>toString()</i> объекта <i>Date()</i> для превращения даты и времени в строку, а затем присвоить эту строку переменной. Вот пример:
<table><tr><td bgcolor=aqua><pre><xmp>
CurrentTime = Today.toString();
</xmp></pre></td></tr></table>
<br>
В завершение нужно соединить строку с текущей датой и временем с концом строки сообщения, прежде чем присвоить сообщение свойству <i>status</i> объекта <i>window</i>.
<p>Скроллинг используется в Интернет довольно широко. И есть риск, что быстро он станет непопулярным. Однако в большинстве страниц, где он применяется, особенно раздражает то, что из-за непрерывного скроллинга становится невозможным прочесть в строке состояния адрес URL. Эту проблему можно было бы решить, позаботившись о приостановке скроллига, если происходит событие MouseOver - и, соответственно, продолжении, когда финсируется onMouseOut. Если вы хотите попытаться создать скроллинг, то, пожалуйста, не используйте стандартный его вариант - пробуйте привнести в него некоторые приятные особенности. Возможен вариант, когда одна часть текста приходит слева, а другая - справа. И когда они встречаются посередине, то в течение некоторых секунд текст остается неизменным. Воспользовавшись небольшой долей фантазии, вы, конечно же, сможете найти еще несколько хороших альтернатив.
<h2>Баннеры</h2>
<p><i>Рекламные баннеры</i> являются обязательным элементом любой коммерческой Web-страницы. В большинстве случаев они располагаются в верхней части страницы, и их назначение состоит в том, чтобы с помощью хитрых приемов привлечь к себе внимание посетителя.
Почти все рекламные баннеры созданы в виде файлов изображений формата GIF,JPG,TIFF и др. Некоторые из них являются анимированными GIF-файлами, то есть набором изображений, которые заключены в одном файле и постоянно меняются на экране. 
Другие являются роликами Flash и могут отображаться только теми браузерами, у которых имеется соответствующая функция. Большинство же рекламных баннеров представляет собой обычное графическое изображение, которое не содержит анимации и не требует установки специальных компонентов.
<br><br><b>Для встраивания рекламного баннера в Web-страницу нужно сделать три шага:</b>
<ol>
<li>Создать несколько рекламных баннеров с помощью графического редактора, например Photoshop. Нужно создать именно несколько баннеров, чтобы они могли меняться на странице с помощью JavaScript.</li>
<li>Создать элемент <i>&LT;img&GT;</i> внутри Web-страницы с указанием высоты и ширины, необходимых для отображения рекламных баннеров.</li>
<li>Создать сценарий JavaScript, который загружает и отображает рекламные баннеры в элементе <i>&LT;img&GT;</i>.</li>
</ol>
<br>
<h3>Для чего это нужно?</h3>
Механизм баннеров позволяет оживить страничку и зрительно создать впечатление, что сайт все время меняется. Наиболее полезна эта функция будет для контент-сайтов - очень удобно создавать баннеры для конкретных статей и размещать их в локальной баннерной системе. Лучше всего, конечно, механизм прокрутки баннеров организовать на стороне сервера с применением Perl, PHP или ASP, но не у всех, к сожалению, есть доступ к CGI-скриптам. И, в этом случае, для решения задачи мы можем воспользоваться встроенными скриптовыми языками.
Несмотря на то, что я буду объяснять как написать небольшую баннерную систему с использованием JavaScript, изложенные принципы вполне применимы и для любых других языков. 
<h3>Условия задачи и ограничения</h3>
А теперь, давайте, более подробно сформулируем условия задачи и введем ряд ограничений, которые упростят программирование. 
Баннерная система должна выполнять следующие функции: 
<ul>
<li>где-то хранить базу данных о баннерах 
<li>случайно выбирать, из вышеупомянутой базы, несколько неповторяющихся баннеров 
<li>обеспечивать механизмы отображения баннеров и перехода на нужную страничку при нажатии 
</ul>
Накладываем на эти условия некоторые ограничения: 
<ul>
<li>баннеры будут фиксированного размера, и храниться в формате GIF или JPEG 
<li>на страничке мы будем одновременно показывать четыре баннера
</ul>
Ну вот, условия и ограничения определены. Теперь, давайте, более подробно рассмотрим, каким образом лучше всего хранить баннеры. В качестве базы для хранения параметров баннеров мы воспользуемся обычным массивом. О каждом из баннеров нам будет необходимо хранить следующую информацию: 
<ul>
<li>имя файла 
<li>альтернативный текст 
<li>адрес странички, на которую ссылается баннер 
</ul>
Для удобства хранения и обновления базы баннеров, лучше всего выделить ее описание в отдельный файл и подключить при помощи механизма вставки внешнего js-файла. Это делается в секции заголовка при помощи следующей конструкции: 
<table><tr><td bgcolor=aqua><pre><xmp>
<script language="JavaScript" src="banners.js"></script>
</xmp></pre></td></tr></table>
<br>
А вот так, будет выглядеть содержимое файла banners.js
<table><tr><td bgcolor=aqua><pre><xmp>
var banners = new Array(

    "pic-01.gif", "Text #1", "http://www.link1.com/",
    "pic-02.gif", "Text #2", "http://www.link2.com/",
    "pic-03.gif", "Text #3", "http://www.link3.com/",
    "pic-04.gif", "Text #4", "http://www.link4.com/",
    "pic-05.gif", "Text #5", "http://www.link5.com/",
    "pic-06.gif", "Text #6", "http://www.link6.com/",
    "pic-07.gif", "Text #7", "http://www.link7.com/",
    "pic-08.gif", "Text #8", "http://www.link8.com/",
    "pic-09.gif", "Text #9", "http://www.link9.com/",
    "pic-10.gif", "Text #10", "http://www.link10.com/"
)
 
</xmp></pre></td></tr></table>
Как видите, структура массива не очень сложна. Под каждый баннер отводится три последовательные ячейки, в которых и хранятся: имя файла, альтернативный текст, адрес ссылки. 
<h3>Программная часть</h3>
Вот мы и добрались до программирования. И, сначала, разберемся с некоторыми моментами.<br>
Начнем с генерации неповторяющихся баннеров. Для выбора произвольного баннера, нам необходимо сгенерировать случайное число в диапазоне от нуля до числа баннеров минус один. Это несложно и делается следующим фрагментом кода: 
<table><tr><td bgcolor=aqua><pre><xmp>
n = Math.floor(Math.random()*(banners.length/3));
</xmp></pre></td></tr></table>
<br>
Но, как мы уже упоминали раньше, мы договорились, что одновременно на страничке будут показываться четыре баннера. И, следовательно, после каждой генерации случайного числа нам необходимо проверить, что данный баннер не совпадает с 3-мя другими. К тому же нам нужно где-то хранить уже сгенерированные числа. Для решения этих задач, мы организуем еще один массив - случайных чисел и при каждой генерации нового числа будем сопоставлять его с найденными ранее. Полный код, который решает эти проблемы, приведен ниже: 
<table><tr><td bgcolor=aqua><pre><xmp>
var i, j;
var flag; // Флажок, используемый для проверки совпадения
var banners_show = 4; // Число показываемых на страничке баннеров

var rand = new Array(banners_show-1);

for (i=0; i<banners_show; i++) {
    do {
        flag=0;
        n = Math.floor(Math.random()*(banners.length/3));
        for (j=0; j<i; j++) {
            if (n == rand[j]) {
                flag=1;
            }
        }
    } while (flag);
    rand[i] = n;
}
</xmp></pre></td></tr></table>
<br>
Ввиду того, что баннеры будут генерироваться на лету, в процессе загрузки страницы, вышеприведенный фрагмент кода необходимо разместить вне функции. В момент, когда броузер перейдет к отрисовке странички, мы уже будем иметь готовый массив случайных чисел.<br>
Для отрисовки баннеров, мы напишем простую функцию, и будем передавать ей в качестве параметра порядковый номер баннера на страничке. Используя этот номер, мы читаем из массива rand[] случайное число для конкретного баннера и уже используя его, находим все необходимые для отрисовки данные: 
<table><tr><td bgcolor=aqua><pre><xmp>
function Show_Banner(number) {

n=rand[number-1];

document.write('<a href="' + banners[n*3+2] + '"><img src="banners/' +
banners[n*3] + '"' + 'border=0 width=' + banner_width + ' height=' +
banner_height + ' alt="' + banners[n*3+1] + '"></a>');

}
</xmp></pre></td></tr></table>
<br>
Вот, практически и все, наша локальная баннерная система готова. Осталось только четыре раза вызвать функцию <i>Show_Banner()</i> из подходящей части странички. Нужно, только не забыть, что код JavaScript отделяется от html тегами &LT;script&GT;&LT;/script&GT;: 
<table><tr><td bgcolor=aqua><pre><xmp>
<script>
<!--
Show_Banner(1);
//-->
</script>

.......

<script>
<!--
Show_Banner(4);
//-->
</script>

</xmp></pre></td></tr></table>
<br>
Для проверки работоспособности локальной баннерной системы, несколько раз нажмите в броузере кнопку Reload и убедитесь, что каждый раз генерируются разные и не совпадающие друг с другом баннеры. 
<h2>Создание слайд-шоу</h2>
По своей концепции слайд-шоу (Slideshow) похоже на рекламный баннер тем, что оно тоже меняет ихображения на Web-странице. Но, в отличие от рекламного баннера, слайд-шоу дает посетителю возможность самому изменять изображения - ему достаточно нажать на кнопку <b>Forward</b> (Вперед) для просмотра следующего изображения или <b>Back</b> (Назад) для просмотра предыдущего.
</BODY>
</HTML>

